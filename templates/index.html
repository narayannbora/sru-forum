{% extends "layout.html" %}
{% block content %}
    
    <div style="margin-bottom: 30px; border-bottom: 1px solid var(--border); padding-bottom: 15px;">
        <h2 style="margin: 0; font-size: 1.8rem; letter-spacing: -0.5px;">ðŸ‘‹ Welcome back, {{ current_user.username }}!</h2>
        <p style="color: var(--text-sub); margin: 5px 0 0 0; font-size: 0.95rem;">
            A quick glance at the newest posts across the SRU Forum.
        </p>
    </div>

    {% if posts|length == 0 %}
        <div class="card" style="text-align: center; padding: 60px; color: var(--text-sub); border: 2px dashed var(--border);">
            <h3>It's quiet here... ðŸ¦—</h3>
            <p>Start by posting something new! <a href="{{ url_for('new_post') }}" style="color: var(--primary); font-weight: 600;">Create a Post</a></p>
        </div>
    {% else %}
        
        <h3 style="color: var(--text-main); margin-bottom: 20px;">ðŸ”¥ Top 6 Latest Posts</h3>

        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
        {% for post in posts %}
            
            {% set border_color = '#9333ea' %}
            {% if post.category == 'skill' %}{% set border_color = '#0079D3' %}
            {% elif post.category == 'market' or post.category == 'lost' %}{% set border_color = '#46D160' %}{% endif %}

            <div class="card" style="padding: 20px; border-left: 4px solid {{ border_color }};">
                
                <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 5px;">
                    <h4 style="margin: 0; font-size: 1.1rem; color: var(--text-main);">
                        <a href="{{ url_for('post_detail', post_id=post.id) }}" style="color: inherit; text-decoration: none;">
                            {{ post.title | truncate(40) }}
                        </a>
                    </h4>
                    <span style="font-size: 0.75rem; color: var(--text-sub); background: var(--bg-input); padding: 3px 8px; border-radius: 4px; text-transform: uppercase;">
                        {{ post.category }}
                    </span>
                </div>
                
                <p style="font-size: 0.85rem; color: var(--text-sub); margin: 0 0 10px 0;">
                    Posted by u/<strong>{{ post.author.username }}</strong> on {{ post.date_posted.strftime('%d %b') }}
                </p>
                
                <p style="font-size: 0.95rem; color: var(--text-sub); margin-bottom: 15px;">
                    {{ post.content | truncate(80) }}
                </p>

                <div style="display: flex; justify-content: space-between; align-items: center;">
                    {% if post.price %}
                        <span style="color: var(--primary); font-weight: bold;">â‚¹{{ post.price }}</span>
                    {% else %}
                        <span></span>
                    {% endif %}
                    <a href="{{ url_for('post_detail', post_id=post.id) }}" style="color: var(--primary); font-size: 0.9rem; font-weight: 600;">View Post â†’</a>
                </div>
            </div>
        {% endfor %}
        </div>
    {% endif %}

{% endblock content %}